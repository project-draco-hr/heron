{
  TopologyMaster.TMasterLocation location=NetworkUtility.awaitResult(stateManager.getTMasterLocation(),5,TimeUnit.SECONDS);
  String endpoint=String.format("http://%s:%d/%s?topologyid=%s",location.getHost(),location.getControllerPort(),command,location.getTopologyId());
  HttpURLConnection connection=null;
  try {
    connection=(HttpURLConnection)new URL(endpoint).openConnection();
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to get connection to tmaster: ",e);
    return false;
  }
  NetworkUtility.sendHttpGetRequest(connection);
  try {
    if (connection.getResponseCode() == HttpURLConnection.HTTP_OK) {
      LOG.info("Successfully  " + command);
      return true;
    }
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to " + command + " :",e);
  }
 finally {
    connection.disconnect();
  }
  return true;
}
