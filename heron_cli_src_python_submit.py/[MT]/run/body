def run(command, parser, cl_args, unknown_args):
    topology_file = cl_args['topology-file-name']
    if (not os.path.isfile(topology_file)):
        print ('Topology jar/tar %s does not exist' % topology_file)
        sys.exit(1)
    if topology_file.endswith('.jar'):
        submit_fatjar(command, parser, cl_args, unknown_args)
    elif (topology_file.endswith('.tar') or topology_file.endswith('.tar.gz')):
        submit_tar(command, parser, cl_args, unknown_args)
    else:
        print 'Unknown file type. Please use .tar or .jar file'
        sys.exit(1)
