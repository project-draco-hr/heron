{
  DefaultConfigLoader config=createRequiredConfig();
  LocalScheduler scheduler=Mockito.spy(LocalScheduler.class.newInstance());
  Mockito.doNothing().when(scheduler).startExecutor(Matchers.anyInt());
  LaunchContext context=new LaunchContext(config,TopologyAPI.Topology.getDefaultInstance());
  scheduler.initialize(context);
  InOrder inOrder=Mockito.inOrder(scheduler);
  for (int i=0; i < shards; i++) {
    inOrder.verify(scheduler).startExecutor(i);
  }
  Mockito.verify(scheduler,Mockito.times(shards)).startExecutor(Matchers.anyInt());
}
