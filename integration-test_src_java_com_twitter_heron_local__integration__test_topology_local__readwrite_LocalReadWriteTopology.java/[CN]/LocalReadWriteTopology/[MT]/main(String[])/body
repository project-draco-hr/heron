{
  if (args.length < 1 || args.length > 2) {
    throw new RuntimeException("Expects 1 or 2 arguments, topology name and max emit count (optional)");
  }
  String topologyName=args[0];
  TestTopologyBuilder builder=new TestTopologyBuilder("testing2.txt");
  builder.setTerminalBoltClass(LOCAL_AGGREGATOR_BOLT_CLASS);
  if (args.length == 1) {
    builder.setSpout("paused-local-spout",new PausedLocalFileSpout("testing.txt"),1);
  }
 else {
    int maxEmits=Integer.parseInt(args[1]);
    builder.setSpout("paused-local-spout",new PausedLocalFileSpout("testing.txt"),1,maxEmits);
  }
  builder.setBolt("identity-bolt",new IdentityBolt(new Fields("line")),1).shuffleGrouping("paused-local-spout");
  Config conf=new BasicConfig();
  HeronSubmitter.submitTopology(topologyName,conf,builder.createTopology());
}
