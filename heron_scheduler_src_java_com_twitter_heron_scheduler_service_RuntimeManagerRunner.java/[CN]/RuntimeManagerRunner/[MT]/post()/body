{
  boolean ret=false;
switch (command) {
case ACTIVATE:
    ret=runtimeManager.postActivate();
  break;
case DEACTIVATE:
ret=runtimeManager.postDeactivate();
break;
case RESTART:
ret=runtimeManager.postRestart(context.getRestartShard());
break;
case KILL:
ret=runtimeManager.postKill() && cleanState(context.getStateManagerAdaptor());
break;
default :
throw new IllegalArgumentException("Unknown command to manage topology");
}
if (!ret) {
LOG.severe(String.format("Failed to post %s locally",command.name()));
return false;
}
return true;
}
