{
  boolean ret=false;
switch (command) {
case ACTIVATE:
    ret=runtimeManager.prepareActivate();
  break;
case DEACTIVATE:
ret=runtimeManager.prepareDeactivate();
break;
case RESTART:
ret=runtimeManager.prepareRestart(context.getRestartShard());
break;
case KILL:
ret=runtimeManager.prepareKill();
break;
default :
throw new IllegalArgumentException("Unknown command to manage topology");
}
if (!ret) {
LOG.severe(String.format("Failed to prepare %s locally",command.name()));
return false;
}
return true;
}
