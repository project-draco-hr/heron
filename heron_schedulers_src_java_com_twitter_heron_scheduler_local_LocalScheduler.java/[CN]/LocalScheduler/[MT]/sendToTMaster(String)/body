{
  String topologyName=LocalContext.topologyName(config);
  SchedulerStateManagerAdaptor stateManager=Runtime.schedulerStateManagerAdaptor(runtime);
  LOG.info("Fetching TMaster location for topology: " + topologyName);
  ListenableFuture<TopologyMaster.TMasterLocation> locationFuture=stateManager.getTMasterLocation(null,LocalContext.topologyName(config));
  TopologyMaster.TMasterLocation location=NetworkUtils.awaitResult(locationFuture,5,TimeUnit.SECONDS);
  LOG.info("Fetched TMaster location for topology: " + topologyName);
  String endpoint=String.format("http://%s:%d/%s?topologyid=%s",location.getHost(),location.getControllerPort(),command,location.getTopologyId());
  LOG.info("HTTP URL for TMaster: " + endpoint);
  HttpURLConnection connection=null;
  try {
    connection=(HttpURLConnection)new URL(endpoint).openConnection();
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to get a HTTP connection to TMaster: ",e);
    return false;
  }
  LOG.info("Successfully opened HTTP connection to TMaster");
  HttpUtils.sendHttpGetRequest(connection);
  LOG.info("Sent the HTTP payload to TMaster");
  boolean success=false;
  try {
    int responseCode=connection.getResponseCode();
    if (responseCode == HttpURLConnection.HTTP_OK) {
      LOG.info("Successfully got a HTTP response from TMaster for " + command);
      success=true;
    }
 else {
      LOG.info(String.format("Non OK HTTP response %d from TMaster for command %s",responseCode,command));
    }
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to receive HTTP response from TMaster for " + command + " :",e);
  }
 finally {
    connection.disconnect();
  }
  return success;
}
