{
  Config runtime=Mockito.spy(Config.newBuilder().build());
  ILauncher launcher=Mockito.mock(ILauncher.class);
  IPacking packing=Mockito.mock(IPacking.class);
  SchedulerStateManagerAdaptor adaptor=Mockito.mock(SchedulerStateManagerAdaptor.class);
  TopologyAPI.Topology topology=createTopology(new com.twitter.heron.api.Config());
  Mockito.doReturn(launcher).when(runtime).get(Keys.launcherClassInstance());
  Mockito.doReturn(packing).when(runtime).get(Keys.packingClassInstance());
  Mockito.doReturn(adaptor).when(runtime).get(Keys.schedulerStateManagerAdaptor());
  Mockito.doReturn(topology).when(runtime).get(Keys.topologyDefinition());
  PackingPlan packingPlan=Mockito.mock(PackingPlan.class);
  Mockito.when(packing.pack()).thenReturn(packingPlan);
  Mockito.when(packingPlan.getInstanceDistribution()).thenReturn(MOCK_PACKING_STRING);
  return runtime;
}
