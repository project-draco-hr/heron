{
  try {
    this.curator=CuratorFrameworkFactory.newClient(zkStr,spoutConfig.zookeeperStoreSessionTimeout,15000,new RetryNTimes(spoutConfig.zookeeperRetryCount,spoutConfig.zookeeperRetryInterval));
    curator.start();
  }
 catch (  IOException e) {
    LOG.info("Curator couldn't connect to Zk",e);
    throw new RuntimeException(e);
  }
  try {
    refresh();
  }
 catch (  Exception e) {
    LOG.info("Malformed Zk Data for Rosette kafka",e);
    throw new RuntimeException(e);
  }
  Runnable refreshTask=new Runnable(){
    @Override public void run(){
      try {
        refresh();
      }
 catch (      Exception e) {
        LOG.error("Failed to refresh partitions for: " + taskIndex,e);
      }
    }
  }
;
  this.executor.scheduleAtFixedRate(refreshTask,0,refreshFreqMSecs,TimeUnit.MILLISECONDS);
}
