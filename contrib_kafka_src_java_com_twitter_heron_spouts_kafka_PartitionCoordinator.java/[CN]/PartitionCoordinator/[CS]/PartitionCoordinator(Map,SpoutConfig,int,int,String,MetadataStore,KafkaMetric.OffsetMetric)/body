{
  this.spoutConfig=spoutConfig;
  this.taskIndex=taskIndex;
  this.totalTasks=totalTasks;
  this.topologyInstanceId=topologyInstanceId;
  this.stormConf=stormConf;
  this.kafkaOffsets=kafkaOffsetMetric;
  this.storage=storage;
  ZkHosts brokerConf=(ZkHosts)this.spoutConfig.hosts;
  this.refreshFreqMSecs=brokerConf.refreshFreqMSecs;
  this.zkPath=brokerConf.brokerZkPath;
  this.topic=spoutConfig.topic;
  this.executor=Executors.newSingleThreadScheduledExecutor();
  scheduleConnectionRefresh(brokerConf.brokerZkStr);
  kafkaOffsetMetric.setCoordinator(this);
}
