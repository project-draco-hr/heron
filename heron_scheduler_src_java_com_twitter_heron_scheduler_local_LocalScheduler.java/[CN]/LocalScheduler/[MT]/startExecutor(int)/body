{
  LOG.info("Starting a new executor: " + shard);
  final Process regularExecutor=ShellUtility.runASyncProcess(true,true,getExecutorCmd(shard),new File(this.localConfig.getWorkingDirectory()));
  processToShard.put(regularExecutor,shard);
  LOG.info("Started new Executor " + shard);
  Runnable r=new Runnable(){
    @Override public void run(){
      try {
        LOG.info("Waiting for shard " + shard + " to finish.");
        regularExecutor.waitFor();
        LOG.info("Shard " + shard + " is done. Exit status: "+ regularExecutor.exitValue());
        if (topologyKilled) {
          LOG.info("Topology is killed. Not to start new executors.");
          return;
        }
        startExecutor(processToShard.remove(regularExecutor));
      }
 catch (      InterruptedException e) {
        LOG.log(Level.SEVERE,"Process is interrupted: ",e);
      }
    }
  }
;
  monitorServices.submit(r);
}
