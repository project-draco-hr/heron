def heron_pex(topology_pex, topology_class_name, tmp_dir):
    Log.debug(('Importing %s from %s' % (topology_class_name, topology_pex)))
    try:
        pex_loader.load_pex(topology_pex)
        topology_class = pex_loader.import_and_get_class(topology_pex, topology_class_name)
        topology_class.write(tmp_dir)
    except Exception:
        traceback.print_exc()
        err_str = 'Topology pex failed to be loaded. Bailing out...'
        raise RuntimeError(err_str)
