{
  LOG.info("Received a submit request from client");
  byte[] requestBody=NetworkUtility.readHttpRequestBody(httpExchange);
  LOG.info("Got request body!");
  String jobDefinitionInJSON=new String(requestBody);
  BaseJob baseJob;
  try {
    baseJob=BaseJob.getJobFromJSONString(jobDefinitionInJSON);
  }
 catch (  Exception e) {
    LOG.log(Level.SEVERE,"Unable to get baseJob. ",e);
    NetworkUtility.sendHttpResponse(false,httpExchange,new byte[0]);
    return;
  }
  boolean isSuccess=false;
  try {
    isSuccess=handleRequest(baseJob);
  }
 catch (  Exception e) {
    LOG.log(Level.SEVERE,"Failed to submit job: " + baseJob.name,e);
  }
  if (isSuccess) {
    LOG.info("Submit done! Send OK response!");
  }
 else {
    LOG.info("Failed to submit topology! Send NOT_AVAILABLE response!");
  }
  NetworkUtility.sendHttpResponse(isSuccess,httpExchange,new byte[0]);
}
