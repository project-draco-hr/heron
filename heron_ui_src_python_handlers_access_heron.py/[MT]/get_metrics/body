@tornado.gen.coroutine
def get_metrics(cluster, environment, topology, timerange, query):
    request_url = tornado.httputil.url_concat(create_url(METRICS_QUERY_URL_FMT), dict(cluster=cluster, environ=environment, topology=topology, starttime=timerange[0], endtime=timerange[1], query=query))
    raise tornado.gen.Return(yield fetch_url_as_json(request_url))
