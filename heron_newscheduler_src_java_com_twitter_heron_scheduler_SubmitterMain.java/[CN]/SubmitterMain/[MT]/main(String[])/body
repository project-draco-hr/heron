{
  String cluster=args[0];
  String role=args[1];
  String environ=args[2];
  String heronHome=args[3];
  String configPath=args[4];
  String configOverrideEncoded=args[5];
  String topologyPackage=args[6];
  String topologyDefnFile=args[7];
  String topologyJarFile=args[8];
  System.out.println(heronHome + " " + configPath);
  TopologyAPI.Topology topology=TopologyUtils.getTopology(topologyDefnFile);
  Config config=Config.expand(Config.newBuilder().putAll(defaultConfigs(heronHome,configPath)).putAll(commandLineConfigs(cluster,role,environ)).putAll(topologyConfigs(topologyPackage,topologyJarFile,topologyDefnFile,topology)).build());
  LOG.info("Static config loaded successfully ");
  LOG.info(config.toString());
  String statemgrClass=Context.stateManagerClass(config);
  IStateManager statemgr=(IStateManager)Class.forName(statemgrClass).newInstance();
  statemgr.initialize(config);
  String topologyName=topology.getName();
  boolean isValid=validateSubmit(statemgr,topologyName);
  boolean isSuccessful=false;
  if (isValid) {
    LOG.info("Topology: " + topologyName + " to be submitted");
    isSuccessful=submitTopology(config,topology,statemgr);
  }
  statemgr.close();
  if (!isSuccessful) {
    LOG.severe("Failed to submit topology " + topologyName);
    Runtime.getRuntime().exit(1);
  }
 else {
    LOG.info("Topology " + topologyName + " submitted successfully");
    Runtime.getRuntime().exit(0);
  }
}
