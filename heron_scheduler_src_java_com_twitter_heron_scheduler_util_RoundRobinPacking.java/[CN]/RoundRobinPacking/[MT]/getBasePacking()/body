{
  Map<String,List<String>> packing=new HashMap<>();
  int numContainer=getNumContainer();
  int totalInstance=TopologyUtility.getTotalInstance(topology);
  if (numContainer > totalInstance) {
    throw new RuntimeException("More containers allocated than instance. Bailing out.");
  }
  for (int i=1; i <= numContainer; ++i) {
    packing.put(getContainerId(i),new ArrayList<String>());
  }
  int index=1;
  int globalTaskIndex=1;
  Map<String,Integer> parallelismMap=TopologyUtility.getComponentParallelism(topology);
  for (  String component : parallelismMap.keySet()) {
    int numInstance=parallelismMap.get(component);
    for (int i=0; i < numInstance; ++i) {
      packing.get(getContainerId(index)).add(getInstanceId(index,component,globalTaskIndex,i));
      index=(index == numContainer) ? 1 : index + 1;
      globalTaskIndex++;
    }
  }
  return packing;
}
