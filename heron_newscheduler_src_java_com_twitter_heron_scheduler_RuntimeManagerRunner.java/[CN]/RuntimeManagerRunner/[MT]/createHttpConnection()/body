{
  SchedulerStateManagerAdaptor statemgr=Runtime.schedulerStateManagerAdaptor(runtime);
  LOG.log(Level.INFO,"Fetching scheduler location from state manager to {0} topology",command);
  ListenableFuture<Scheduler.SchedulerLocation> locationFuture=statemgr.getSchedulerLocation(null,Runtime.topologyName(runtime));
  Scheduler.SchedulerLocation schedulerLocation=NetworkUtils.awaitResult(locationFuture,5,TimeUnit.SECONDS);
  if (schedulerLocation == null) {
    LOG.log(Level.INFO,"Failed to get scheduler location to {0} topology",command);
    return null;
  }
  LOG.info("Scheduler is listening on location: " + schedulerLocation.toString());
  String endpoint=getCommandEndpoint(schedulerLocation.getHttpEndpoint(),command);
  HttpURLConnection connection;
  try {
    connection=HttpUtils.getConnection(endpoint);
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to connect to scheduler http endpoint: {0}",endpoint);
    return null;
  }
  return connection;
}
