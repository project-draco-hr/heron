{
  SchedulerStateManagerAdaptor statemgr=Runtime.schedulerStateManagerAdaptor(runtime);
  ListenableFuture<PhysicalPlans.PhysicalPlan> physicalPlanFuture=statemgr.getPhysicalPlan(null,topologyName);
  PhysicalPlans.PhysicalPlan plan=NetworkUtils.awaitResult(physicalPlanFuture,5,TimeUnit.SECONDS);
  if (plan == null) {
    LOG.severe("Failed to get physical plan for topology: " + topologyName);
    return null;
  }
  return plan.getTopology().getState();
}
