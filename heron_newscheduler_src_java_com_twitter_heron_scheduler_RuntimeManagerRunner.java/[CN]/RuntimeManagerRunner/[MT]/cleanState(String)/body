{
  LOG.info("Cleaning up Heron State");
  SchedulerStateManagerAdaptor statemgr=Runtime.schedulerStateManagerAdaptor(runtime);
  ListenableFuture<Boolean> booleanFuture;
  Boolean futureResult;
  booleanFuture=statemgr.deleteTopology(topologyName);
  futureResult=NetworkUtils.awaitResult(booleanFuture,5,TimeUnit.SECONDS);
  if (futureResult == null || !futureResult) {
    LOG.severe("Failed to clear topology state");
    return false;
  }
  booleanFuture=statemgr.deleteExecutionState(topologyName);
  futureResult=NetworkUtils.awaitResult(booleanFuture,5,TimeUnit.SECONDS);
  if (futureResult == null || !futureResult) {
    LOG.severe("Failed to clear execution state");
    return false;
  }
  booleanFuture=statemgr.deleteTMasterLocation(topologyName);
  futureResult=NetworkUtils.awaitResult(booleanFuture,5,TimeUnit.SECONDS);
  if (futureResult == null || !futureResult) {
    LOG.severe("Failed to clear TMaster location. Check whether TMaster set it correctly.");
  }
  booleanFuture=statemgr.deletePhysicalPlan(topologyName);
  futureResult=NetworkUtils.awaitResult(booleanFuture,5,TimeUnit.SECONDS);
  if (futureResult == null || !futureResult) {
    LOG.severe("Failed to clear physical plan. Check whether TMaster set it correctly.");
  }
  booleanFuture=statemgr.deleteSchedulerLocation(topologyName);
  futureResult=NetworkUtils.awaitResult(booleanFuture,5,TimeUnit.SECONDS);
  if (futureResult == null || !futureResult) {
    LOG.severe("Failed to clear scheduler location. Check whether Scheduler set it correctly.");
  }
  LOG.info("Cleaned up Heron State");
  return true;
}
