{
synchronized (this) {
    LOG.fine("Received Resource Offers");
    if (!isReady()) {
      LOG.info("Not finished reconciliation, reclining offers.");
      return;
    }
    Map<Protos.Offer,TaskResources> offerResources=new HashMap<>();
    for (    Protos.Offer offer : offers) {
      offerResources.put(offer,TaskResources.apply(offer,config.role));
    }
    List<LaunchableTasks> tasksToLaunch=isReady() ? generateLaunchableTasks(offerResources) : new LinkedList<LaunchableTasks>();
    LOG.fine("Declining unused offers.");
    Set<String> usedOffers=new HashSet<>();
    for (    LaunchableTasks task : tasksToLaunch) {
      usedOffers.add(task.offer.getId().getValue());
    }
    for (    Protos.Offer offer : offers) {
      if (!usedOffers.contains(offer.getId().getValue())) {
        driver.declineOffer(offer.getId());
      }
    }
    launchTasks(driver,tasksToLaunch);
  }
}
