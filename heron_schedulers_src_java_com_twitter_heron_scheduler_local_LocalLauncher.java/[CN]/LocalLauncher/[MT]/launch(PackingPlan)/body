{
  LOG.info("Launching topology for local cluster " + LocalContext.cluster(config));
  TopologyAPI.Topology topology=Runtime.topology(runtime);
  Config sandboxConfig=Config.expand(Config.newBuilder().putAll(ClusterDefaults.getSandboxDefaults()).putAll(ClusterConfig.loadBasicSandboxConfig()).build());
  LOG.info("loaded sandbox config " + sandboxConfig);
  if (!downloadAndExtractPackages()) {
    LOG.severe("Failed to download the core and topology packages");
    return false;
  }
  String schedulerClassPath=new StringBuilder().append(LocalContext.schedulerSandboxClassPath(sandboxConfig)).append(":").append(LocalContext.packingSandboxClassPath(sandboxConfig)).append(":").append(LocalContext.stateManagerSandboxClassPath(sandboxConfig)).toString();
  String schedulerCmd=String.format("%s %s %s %s %s %s %s %s %s %s","java","-cp",schedulerClassPath,"com.twitter.heron.scheduler.SchedulerMain","--cluster " + LocalContext.cluster(config),"--role " + LocalContext.role(config),"--environment " + LocalContext.environ(config),"--topology_name " + topology.getName(),"--topology_jar " + LocalContext.topologyJarFile(config),"--http_port " + NetworkUtils.getFreePort());
  LOG.info("Scheduler command line: " + schedulerCmd.toString());
  Process p=ShellUtils.runASyncProcess(true,schedulerCmd.toString(),new File(topologyWorkingDirectory));
  if (p == null) {
    LOG.severe("Failed to start SchedulerMain using: " + schedulerCmd);
    return false;
  }
  LOG.info(String.format("For checking the status and logs of the topology, use the working directory %s",LocalContext.workingDirectory(config)));
  return true;
}
