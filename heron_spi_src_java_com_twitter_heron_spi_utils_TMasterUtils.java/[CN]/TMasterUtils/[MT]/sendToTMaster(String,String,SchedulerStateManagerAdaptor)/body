{
  LOG.fine("Fetching TMaster location for topology: " + topologyName);
  TopologyMaster.TMasterLocation location=stateManager.getTMasterLocation(topologyName);
  if (location == null) {
    LOG.severe("Failed to fetch TMaster Location for topology: " + topologyName);
    return false;
  }
  LOG.fine("Fetched TMaster location for topology: " + topologyName);
  String endpoint=String.format("http://%s:%d/%s?topologyid=%s",location.getHost(),location.getControllerPort(),command,location.getTopologyId());
  LOG.fine("HTTP URL for TMaster: " + endpoint);
  HttpURLConnection connection=null;
  try {
    connection=(HttpURLConnection)new URL(endpoint).openConnection();
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to get a HTTP connection to TMaster: ",e);
    return false;
  }
  LOG.fine("Successfully opened HTTP connection to TMaster");
  NetworkUtils.sendHttpGetRequest(connection);
  LOG.fine("Sent the HTTP payload to TMaster");
  boolean success=false;
  try {
    int responseCode=connection.getResponseCode();
    if (responseCode == HttpURLConnection.HTTP_OK) {
      LOG.fine("Successfully got a HTTP response from TMaster for " + command);
      success=true;
    }
 else {
      LOG.fine(String.format("Non OK HTTP response %d from TMaster for command %s",responseCode,command));
    }
  }
 catch (  IOException e) {
    LOG.log(Level.SEVERE,"Failed to receive HTTP response from TMaster for " + command + " :",e);
  }
 finally {
    connection.disconnect();
  }
  return success;
}
