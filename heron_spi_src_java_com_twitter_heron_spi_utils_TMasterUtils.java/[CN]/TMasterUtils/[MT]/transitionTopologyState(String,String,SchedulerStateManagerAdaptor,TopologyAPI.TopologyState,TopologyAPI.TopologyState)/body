{
  TopologyAPI.TopologyState state=TMasterUtils.getRuntimeTopologyState(topologyName,statemgr);
  if (state == null) {
    LOG.severe("Topology still not initialized.");
    return false;
  }
  if (state == expectedState) {
    LOG.log(Level.SEVERE,"Topology is already {0}ed",topologyStateControlCommand);
    return true;
  }
  if (state != startState) {
    LOG.log(Level.SEVERE,"Topology not in {0} state",startState);
    return false;
  }
  if (!TMasterUtils.sendToTMaster(topologyStateControlCommand,topologyName,statemgr)) {
    LOG.log(Level.SEVERE,"Failed to {0} topology: {1} ",new Object[]{topologyStateControlCommand,topologyName});
    return false;
  }
  LOG.log(Level.INFO,"Topology {0}ed successfully.",topologyStateControlCommand);
  return true;
}
