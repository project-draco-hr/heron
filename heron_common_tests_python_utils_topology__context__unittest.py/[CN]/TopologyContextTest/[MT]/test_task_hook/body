def test_task_hook(self):
    task_hook = mock_generator.MockTaskHook()
    self.assertFalse(self.context.hook_exists)
    self.context.add_task_hook(task_hook)
    self.assertTrue(self.context.hook_exists)
    self.context.invoke_hook_prepare()
    self.context.invoke_hook_emit(None, None, None)
    self.assertTrue(task_hook.emit_called)
    self.context.invoke_hook_spout_ack(None, 0.1)
    self.assertTrue(task_hook.spout_ack_called)
    self.context.invoke_hook_spout_fail(None, 0.1)
    self.assertTrue(task_hook.spout_fail_called)
    self.context.invoke_hook_bolt_execute(None, 0.1)
    self.assertTrue(task_hook.bolt_exec_called)
    self.context.invoke_hook_bolt_ack(None, 0.1)
    self.assertTrue(task_hook.bolt_ack_called)
    self.context.invoke_hook_bolt_fail(None, 0.1)
    self.assertTrue(task_hook.bolt_fail_called)
