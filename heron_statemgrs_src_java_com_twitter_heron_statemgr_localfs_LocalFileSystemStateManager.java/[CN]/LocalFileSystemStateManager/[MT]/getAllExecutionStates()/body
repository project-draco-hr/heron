{
  SettableFuture<List<ExecutionEnvironment.ExecutionState>> future=SettableFuture.create();
  ExecutionEnvironment.ExecutionState executionState;
  List<ExecutionEnvironment.ExecutionState> executionStates=new LinkedList<ExecutionEnvironment.ExecutionState>();
  File folder=new File(getExecutionStateDir());
  File[] files=folder.listFiles();
  for (  File file : files) {
    byte[] data=FileUtils.readFromFile(file.getAbsolutePath());
    try {
      executionState=ExecutionEnvironment.ExecutionState.parseFrom(data);
      executionStates.add(executionState);
    }
 catch (    InvalidProtocolBufferException e) {
      future.setException(new RuntimeException("Could not parse ExecutionState",e));
      return future;
    }
  }
  future.set(executionStates);
  return future;
}
