{
  String topologyPkg="some-file.tar";
  IConfigLoader config=createConfig();
  String configLoader=config.getClass().getName();
  String submitterConfigFile="";
  String configOverride=DatatypeConverter.printBase64Binary("key:value".getBytes(Charset.forName("UTF-8")));
  IUploader failUploader=mock(IUploader.class);
  ILauncher mockLauncher=mock(ILauncher.class);
  PowerMockito.spy(SubmitterMain.class);
  PowerMockito.spy(Factory.class);
  PowerMockito.doReturn(mock(IStateManager.class)).when(Factory.class,"makeStateManager",anyString());
  PowerMockito.doReturn(config).when(Factory.class,"makeConfigLoader",eq(configLoader));
  PowerMockito.doReturn(failUploader).when(Factory.class,"makeUploader",anyString());
  PowerMockito.doReturn(mockLauncher).when(Factory.class,"makeLauncher",anyString());
  when(failUploader.uploadPackage()).thenReturn(null);
  assertTrue(!SubmitterMain.submitTopology(topologyPkg,configLoader,submitterConfigFile,configOverride,createTopology(new Config())));
  verify(mockLauncher,never()).initialize(any(LaunchContext.class));
  verify(mockLauncher,never()).launchTopology(any(PackingPlan.class));
}
