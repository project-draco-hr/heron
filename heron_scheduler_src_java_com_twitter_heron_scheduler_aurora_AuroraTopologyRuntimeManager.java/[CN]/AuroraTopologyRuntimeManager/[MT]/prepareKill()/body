{
  TopologyAPI.Topology topology=null;
  try {
    topology=context.getStateManagerAdaptor().getTopology().get();
  }
 catch (  InterruptedException|ExecutionException e) {
    LOG.log(Level.SEVERE,"Fetch topology failed. Check if topology is running",e);
    return false;
  }
  String batchSize=context.getProperty(HERON_AURORA_BATCH_SIZE,(1 + TopologyUtility.getNumContainer(topology)) + "");
  ArrayList<String> auroraCmd=new ArrayList<>(Arrays.asList("aurora","job","killall","--batch-size",batchSize,String.format("%s/%s/%s/%s",cluster,role,environ,topologyName)));
  if (context.isVerbose()) {
    auroraCmd.add("--verbose");
  }
  LOG.info("auroraCmd=" + auroraCmd);
  if (0 == ShellUtility.runProcess(context.isVerbose(),auroraCmd.toArray(new String[auroraCmd.size()]),null,null)) {
    LOG.info("Killed topology");
    return true;
  }
 else {
    LOG.severe("Failed to kill topology.");
    return false;
  }
}
