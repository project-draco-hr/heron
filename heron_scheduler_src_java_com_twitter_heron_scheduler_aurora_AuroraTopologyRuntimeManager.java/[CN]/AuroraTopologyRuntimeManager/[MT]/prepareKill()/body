{
  TopologyAPI.Topology topology=null;
  try {
    topology=context.getStateManagerAdaptor().getTopology().get();
  }
 catch (  InterruptedException|ExecutionException e) {
    LOG.log(Level.SEVERE,"Fetch topology failed. Check if topology is running",e);
    return false;
  }
  String batchSize=context.getProperty(HERON_BATCH_SIZE,(1 + TopologyUtility.getNumContainer(topology)) + "");
  String[] auroraCmd={"aurora","job","killall","--batch-size",batchSize,String.format("%s/%s/%s/%s",dc,role,environ,topologyName),context.isVerbose() ? "--verbose" : ""};
  LOG.info("auroraCmd=" + Arrays.toString(auroraCmd));
  if (0 == ShellUtility.runProcess(context.isVerbose(),auroraCmd,null,null)) {
    LOG.info("Killed topology");
    return true;
  }
 else {
    LOG.severe("Failed to kill topology.");
    return false;
  }
}
