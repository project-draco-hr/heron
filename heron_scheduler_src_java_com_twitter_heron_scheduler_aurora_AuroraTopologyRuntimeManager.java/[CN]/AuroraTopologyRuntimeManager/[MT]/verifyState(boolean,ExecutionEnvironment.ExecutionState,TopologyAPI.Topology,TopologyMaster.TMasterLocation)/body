{
  if (tMasterLocation == null || executionState == null || topology == null) {
    LOG.severe("Failed to read state. Check if topology is running");
    return false;
  }
  if (!executionState.getRole().equals(role)) {
    LOG.severe("Role not valid. Expected role: " + executionState.getRole());
    return false;
  }
  if (activate) {
    if (!topology.getState().equals(TopologyAPI.TopologyState.PAUSED)) {
      LOG.info("Topology not deactivated. State: " + topology.getState());
      return false;
    }
  }
 else {
    if (!topology.getState().equals(TopologyAPI.TopologyState.RUNNING)) {
      LOG.info("Topology not active. State: " + topology.getState());
      return false;
    }
  }
  return true;
}
