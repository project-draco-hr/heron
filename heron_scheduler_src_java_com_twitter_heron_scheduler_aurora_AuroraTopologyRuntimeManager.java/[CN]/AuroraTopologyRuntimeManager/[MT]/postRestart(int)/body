{
  TopologyAPI.Topology topology=null;
  try {
    topology=context.getStateManagerAdaptor().getTopology().get();
  }
 catch (  InterruptedException|ExecutionException e) {
    LOG.log(Level.SEVERE,"Fetch topology failed. Check if topology is running",e);
  }
  String batchSize=context.getProperty(HERON_BATCH_SIZE,(1 + TopologyUtility.getNumContainer(topology)) + "");
  String[] auroraCmd=new String[]{"aurora","job","restart","--batch-size",batchSize,restartShardId == -1 ? String.format("%s/%s/%s/%s",dc,role,environ,topologyName) : String.format("%s/%s/%s/%s/%s",dc,role,environ,topologyName,restartShardId),context.isVerbose() ? "--verbose" : ""};
  return 0 == ShellUtility.runProcess(context.isVerbose(),auroraCmd,null,null);
}
